# This Amplify Console build configuration will deploy the Test Centre website.
# You will need to set an environment variable in Amplify, defining the API
# Gateway endpoint for your Step Functions callback interface.
# The environment variable should be called APIGW_ENDPOINT
# See src/frontend/testcentre/README.md for more details.
version: 0.1
frontend:
  phases:
    build:
      commands:
        # First get the testcentre set up.
        - cd src/frontend/testcentre
        - ./replace-endpoint.sh $APIGW_ENDPOINT
        - yarn global add @vue/cli
        - yarn install
        - yarn build
        # Then, prepare the backend site for exam administrators.
        - cd ../admin
        - ./replace-endpoint.sh $APIGW_ENDPOINT
        - cd ../testcentre
        #  Put the admin interface into the dist folder for deployment.
        - cp -r ../admin dist/
  artifacts:
    baseDirectory: src/frontend/testcentre/dist
    files:
      - '**/*'
  cache:
    paths: []
